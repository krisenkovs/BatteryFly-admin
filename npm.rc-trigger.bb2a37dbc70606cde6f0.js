"use strict";(self.webpackChunksmartcrm=self.webpackChunksmartcrm||[]).push([[24],{4768:(e,o,n)=>{n.d(o,{Z:()=>X});var t=n(1413),i=n(7462),r=n(5671),u=n(3144),s=n(7326),a=n(9340),l=n(8557),c=n(7294),p=n(3935),d=n(5164),f=n(4999),h=n(4203),m=n(2550),v=n(4019),g=n(9015),C=n(4184),T=n.n(C);function M(e,o,n){return n?e[0]===o[0]:e[0]===o[0]&&e[1]===o[1]}var k=n(9439),y=n(4925),w=n(1131),P=n(3441);function D(e){var o=e.prefixCls,n=e.motion,t=e.animation,i=e.transitionName;return n||(t?{motionName:"".concat(o,"-").concat(t)}:i?{motionName:i}:null)}function x(e){var o=e.prefixCls,n=e.visible,r=e.zIndex,u=e.mask,s=e.maskMotion,a=e.maskAnimation,l=e.maskTransitionName;if(!u)return null;var p={};return(s||l||a)&&(p=(0,t.Z)({motionAppear:!0},D({motion:s,prefixCls:o,transitionName:l,animation:a}))),c.createElement(P.default,(0,i.Z)({},p,{visible:n,removeOnLeave:!0}),(function(e){var n=e.className;return c.createElement("div",{style:{zIndex:r},className:T()("".concat(o,"-mask"),n)})}))}var b=n(9),E=n(8410),O=n(4165),Z=n(5861),N=n(470),H=["measure","alignPre","align",null,"motion"];var S=c.forwardRef((function(e,o){var n=e.visible,r=e.prefixCls,u=e.className,s=e.style,a=e.children,l=e.zIndex,p=e.stretch,f=e.destroyPopupOnHide,h=e.forceRender,m=e.align,v=e.point,g=e.getRootDomNode,C=e.getClassNameFromAlign,M=e.onAlign,y=e.onMouseEnter,w=e.onMouseLeave,x=e.onMouseDown,S=e.onTouchStart,V=e.onClick,R=(0,c.useRef)(),A=(0,c.useRef)(),L=(0,c.useState)(),F=(0,k.Z)(L,2),I=F[0],B=F[1],z=function(e){var o=c.useState({width:0,height:0}),n=(0,k.Z)(o,2),t=n[0],i=n[1];return[c.useMemo((function(){var o={};if(e){var n=t.width,i=t.height;-1!==e.indexOf("height")&&i?o.height=i:-1!==e.indexOf("minHeight")&&i&&(o.minHeight=i),-1!==e.indexOf("width")&&n?o.width=n:-1!==e.indexOf("minWidth")&&n&&(o.minWidth=n)}return o}),[e,t]),function(e){i({width:e.offsetWidth,height:e.offsetHeight})}]}(p),U=(0,k.Z)(z,2),W=U[0],Y=U[1];var X=function(e,o){var n=(0,N.Z)(null),t=(0,k.Z)(n,2),i=t[0],r=t[1],u=(0,c.useRef)();function s(e){r(e,!0)}function a(){d.Z.cancel(u.current)}return(0,c.useEffect)((function(){s("measure")}),[e]),(0,c.useEffect)((function(){"measure"===i&&o(),i&&(u.current=(0,d.Z)((0,Z.Z)((0,O.Z)().mark((function e(){var o,n;return(0,O.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=H.indexOf(i),(n=H[o+1])&&-1!==o&&s(n);case 3:case"end":return e.stop()}}),e)})))))}),[i]),(0,c.useEffect)((function(){return function(){a()}}),[]),[i,function(e){a(),u.current=(0,d.Z)((function(){s((function(e){switch(i){case"align":return"motion";case"motion":return"stable"}return e})),null==e||e()}))}]}(n,(function(){p&&Y(g())})),j=(0,k.Z)(X,2),Q=j[0],q=j[1],G=(0,c.useState)(0),J=(0,k.Z)(G,2),K=J[0],$=J[1],_=(0,c.useRef)();function ee(){var e;null===(e=R.current)||void 0===e||e.forceAlign()}function oe(e,o){var n=C(o);I!==n&&B(n),$((function(e){return e+1})),"align"===Q&&(null==M||M(e,o))}(0,E.Z)((function(){"alignPre"===Q&&$(0)}),[Q]),(0,E.Z)((function(){"align"===Q&&(K<2?ee():q((function(){var e;null===(e=_.current)||void 0===e||e.call(_)})))}),[K]);var ne=(0,t.Z)({},D(e));function te(){return new Promise((function(e){_.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var o=ne[e];ne[e]=function(e,n){return q(),null==o?void 0:o(e,n)}})),c.useEffect((function(){ne.motionName||"motion"!==Q||q()}),[ne.motionName,Q]),c.useImperativeHandle(o,(function(){return{forceAlign:ee,getElement:function(){return A.current}}}));var ie=(0,t.Z)((0,t.Z)({},W),{},{zIndex:l,opacity:"motion"!==Q&&"stable"!==Q&&n?0:void 0,pointerEvents:n||"stable"===Q?void 0:"none"},s),re=!0;!(null==m?void 0:m.points)||"align"!==Q&&"stable"!==Q||(re=!1);var ue=a;return c.Children.count(a)>1&&(ue=c.createElement("div",{className:"".concat(r,"-content")},a)),c.createElement(P.default,(0,i.Z)({visible:n,ref:A,leavedClassName:"".concat(r,"-hidden")},ne,{onAppearPrepare:te,onEnterPrepare:te,removeOnLeave:f,forceRender:h}),(function(e,o){var n=e.className,i=e.style,s=T()(r,u,I,n);return c.createElement(b.Z,{target:v||g,key:"popup",ref:R,monitorWindowResize:!0,disabled:re,align:m,onAlign:oe},c.createElement("div",{ref:o,className:s,onMouseEnter:y,onMouseLeave:w,onMouseDownCapture:x,onTouchStartCapture:S,onClick:V,style:(0,t.Z)((0,t.Z)({},i),ie)},ue))}))}));S.displayName="PopupInner";const V=S;var R=c.forwardRef((function(e,o){var n=e.prefixCls,r=e.visible,u=e.zIndex,s=e.children,a=e.mobile,l=(a=void 0===a?{}:a).popupClassName,p=a.popupStyle,d=a.popupMotion,f=void 0===d?{}:d,h=a.popupRender,m=e.onClick,v=c.useRef();c.useImperativeHandle(o,(function(){return{forceAlign:function(){},getElement:function(){return v.current}}}));var g=(0,t.Z)({zIndex:u},p),C=s;return c.Children.count(s)>1&&(C=c.createElement("div",{className:"".concat(n,"-content")},s)),h&&(C=h(C)),c.createElement(P.default,(0,i.Z)({visible:r,ref:v,removeOnLeave:!0},f),(function(e,o){var i=e.className,r=e.style,u=T()(n,l,i);return c.createElement("div",{ref:o,className:u,onClick:m,style:(0,t.Z)((0,t.Z)({},r),g)},C)}))}));R.displayName="MobilePopupInner";const A=R;var L=["visible","mobile"],F=c.forwardRef((function(e,o){var n=e.visible,r=e.mobile,u=(0,y.Z)(e,L),s=(0,c.useState)(n),a=(0,k.Z)(s,2),l=a[0],p=a[1],d=(0,c.useState)(!1),f=(0,k.Z)(d,2),h=f[0],m=f[1],v=(0,t.Z)((0,t.Z)({},u),{},{visible:l});(0,c.useEffect)((function(){p(n),n&&r&&m((0,w.Z)())}),[n,r]);var g=h?c.createElement(A,(0,i.Z)({},v,{mobile:r,ref:o})):c.createElement(V,(0,i.Z)({},v,{ref:o}));return c.createElement("div",null,c.createElement(x,v),g)}));F.displayName="Popup";const I=F;const B=c.createContext(null);function z(){}function U(){return""}function W(e){return e?e.ownerDocument:window.document}var Y=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];const X=function(e){var o=function(o){(0,a.Z)(g,o);var n=(0,l.Z)(g);function g(e){var o,t;return(0,r.Z)(this,g),(o=n.call(this,e)).popupRef=c.createRef(),o.triggerRef=c.createRef(),o.portalContainer=void 0,o.attachId=void 0,o.clickOutsideHandler=void 0,o.touchOutsideHandler=void 0,o.contextMenuOutsideHandler1=void 0,o.contextMenuOutsideHandler2=void 0,o.mouseDownTimeout=void 0,o.focusTime=void 0,o.preClickTime=void 0,o.preTouchTime=void 0,o.delayTimer=void 0,o.hasPopupMouseDown=void 0,o.onMouseEnter=function(e){var n=o.props.mouseEnterDelay;o.fireEvents("onMouseEnter",e),o.delaySetPopupVisible(!0,n,n?null:e)},o.onMouseMove=function(e){o.fireEvents("onMouseMove",e),o.setPoint(e)},o.onMouseLeave=function(e){o.fireEvents("onMouseLeave",e),o.delaySetPopupVisible(!1,o.props.mouseLeaveDelay)},o.onPopupMouseEnter=function(){o.clearDelayTimer()},o.onPopupMouseLeave=function(e){var n;e.relatedTarget&&!e.relatedTarget.setTimeout&&(0,f.Z)(null===(n=o.popupRef.current)||void 0===n?void 0:n.getElement(),e.relatedTarget)||o.delaySetPopupVisible(!1,o.props.mouseLeaveDelay)},o.onFocus=function(e){o.fireEvents("onFocus",e),o.clearDelayTimer(),o.isFocusToShow()&&(o.focusTime=Date.now(),o.delaySetPopupVisible(!0,o.props.focusDelay))},o.onMouseDown=function(e){o.fireEvents("onMouseDown",e),o.preClickTime=Date.now()},o.onTouchStart=function(e){o.fireEvents("onTouchStart",e),o.preTouchTime=Date.now()},o.onBlur=function(e){o.fireEvents("onBlur",e),o.clearDelayTimer(),o.isBlurToHide()&&o.delaySetPopupVisible(!1,o.props.blurDelay)},o.onContextMenu=function(e){e.preventDefault(),o.fireEvents("onContextMenu",e),o.setPopupVisible(!0,e)},o.onContextMenuClose=function(){o.isContextMenuToShow()&&o.close()},o.onClick=function(e){if(o.fireEvents("onClick",e),o.focusTime){var n;if(o.preClickTime&&o.preTouchTime?n=Math.min(o.preClickTime,o.preTouchTime):o.preClickTime?n=o.preClickTime:o.preTouchTime&&(n=o.preTouchTime),Math.abs(n-o.focusTime)<20)return;o.focusTime=0}o.preClickTime=0,o.preTouchTime=0,o.isClickToShow()&&(o.isClickToHide()||o.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var t=!o.state.popupVisible;(o.isClickToHide()&&!t||t&&o.isClickToShow())&&o.setPopupVisible(!o.state.popupVisible,e)},o.onPopupMouseDown=function(){var e;(o.hasPopupMouseDown=!0,clearTimeout(o.mouseDownTimeout),o.mouseDownTimeout=window.setTimeout((function(){o.hasPopupMouseDown=!1}),0),o.context)&&(e=o.context).onPopupMouseDown.apply(e,arguments)},o.onDocumentClick=function(e){if(!o.props.mask||o.props.maskClosable){var n=e.target,t=o.getRootDomNode(),i=o.getPopupDomNode();(0,f.Z)(t,n)&&!o.isContextMenuOnly()||(0,f.Z)(i,n)||o.hasPopupMouseDown||o.close()}},o.getRootDomNode=function(){var e=o.props.getTriggerDOMNode;if(e)return e(o.triggerRef.current);try{var n=(0,h.Z)(o.triggerRef.current);if(n)return n}catch(t){}return p.findDOMNode((0,s.Z)(o))},o.getPopupClassNameFromAlign=function(e){var n=[],t=o.props,i=t.popupPlacement,r=t.builtinPlacements,u=t.prefixCls,s=t.alignPoint,a=t.getPopupClassNameFromAlign;return i&&r&&n.push(function(e,o,n,t){for(var i=n.points,r=Object.keys(e),u=0;u<r.length;u+=1){var s=r[u];if(M(e[s].points,i,t))return"".concat(o,"-placement-").concat(s)}return""}(r,u,e,s)),a&&n.push(a(e)),n.join(" ")},o.getComponent=function(){var e=o.props,n=e.prefixCls,t=e.destroyPopupOnHide,r=e.popupClassName,u=e.onPopupAlign,s=e.popupMotion,a=e.popupAnimation,l=e.popupTransitionName,p=e.popupStyle,d=e.mask,f=e.maskAnimation,h=e.maskTransitionName,m=e.maskMotion,v=e.zIndex,g=e.popup,C=e.stretch,T=e.alignPoint,M=e.mobile,k=e.forceRender,y=e.onPopupClick,w=o.state,P=w.popupVisible,D=w.point,x=o.getPopupAlign(),b={};return o.isMouseEnterToShow()&&(b.onMouseEnter=o.onPopupMouseEnter),o.isMouseLeaveToHide()&&(b.onMouseLeave=o.onPopupMouseLeave),b.onMouseDown=o.onPopupMouseDown,b.onTouchStart=o.onPopupMouseDown,c.createElement(I,(0,i.Z)({prefixCls:n,destroyPopupOnHide:t,visible:P,point:T&&D,className:r,align:x,onAlign:u,animation:a,getClassNameFromAlign:o.getPopupClassNameFromAlign},b,{stretch:C,getRootDomNode:o.getRootDomNode,style:p,mask:d,zIndex:v,transitionName:l,maskAnimation:f,maskTransitionName:h,maskMotion:m,ref:o.popupRef,motion:s,mobile:M,forceRender:k,onClick:y}),"function"==typeof g?g():g)},o.attachParent=function(e){d.Z.cancel(o.attachId);var n,t=o.props,i=t.getPopupContainer,r=t.getDocument,u=o.getRootDomNode();i?(u||0===i.length)&&(n=i(u)):n=r(o.getRootDomNode()).body,n?n.appendChild(e):o.attachId=(0,d.Z)((function(){o.attachParent(e)}))},o.getContainer=function(){if(!o.portalContainer){var e=(0,o.props.getDocument)(o.getRootDomNode()).createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",o.portalContainer=e}return o.attachParent(o.portalContainer),o.portalContainer},o.setPoint=function(e){o.props.alignPoint&&e&&o.setState({point:{pageX:e.pageX,pageY:e.pageY}})},o.handlePortalUpdate=function(){o.state.prevPopupVisible!==o.state.popupVisible&&o.props.afterPopupVisibleChange(o.state.popupVisible)},o.triggerContextValue={onPopupMouseDown:o.onPopupMouseDown},t="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,o.state={prevPopupVisible:t,popupVisible:t},Y.forEach((function(e){o["fire".concat(e)]=function(n){o.fireEvents(e,n)}})),o}return(0,u.Z)(g,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,o=this.props;if(this.state.popupVisible)return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(e=o.getDocument(this.getRootDomNode()),this.clickOutsideHandler=(0,v.Z)(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||o.getDocument(this.getRootDomNode()),this.touchOutsideHandler=(0,v.Z)(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||o.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=(0,v.Z)(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=(0,v.Z)(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),d.Z.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,o=e.popupPlacement,n=e.popupAlign,i=e.builtinPlacements;return o&&i?function(e,o,n){var i=e[o]||{};return(0,t.Z)((0,t.Z)({},i),n)}(i,o,n):n}},{key:"setPopupVisible",value:function(e,o){var n=this.props.alignPoint,t=this.state.popupVisible;this.clearDelayTimer(),t!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:t}),this.props.onPopupVisibleChange(e)),n&&o&&e&&this.setPoint(o)}},{key:"delaySetPopupVisible",value:function(e,o,n){var t=this,i=1e3*o;if(this.clearDelayTimer(),i){var r=n?{pageX:n.pageX,pageY:n.pageY}:null;this.delayTimer=window.setTimeout((function(){t.setPopupVisible(e,r),t.clearDelayTimer()}),i)}else this.setPopupVisible(e,n)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var o=this.props.children.props,n=this.props;return o[e]&&n[e]?this["fire".concat(e)]:o[e]||n[e]}},{key:"isClickToShow",value:function(){var e=this.props,o=e.action,n=e.showAction;return-1!==o.indexOf("click")||-1!==n.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,o=e.action,n=e.showAction;return-1!==o.indexOf("contextMenu")||-1!==n.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,o=e.action,n=e.hideAction;return-1!==o.indexOf("click")||-1!==n.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,o=e.action,n=e.showAction;return-1!==o.indexOf("hover")||-1!==n.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,o=e.action,n=e.hideAction;return-1!==o.indexOf("hover")||-1!==n.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,o=e.action,n=e.showAction;return-1!==o.indexOf("focus")||-1!==n.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,o=e.action,n=e.hideAction;return-1!==o.indexOf("focus")||-1!==n.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,o){var n=this.props.children.props[e];n&&n(o);var t=this.props[e];t&&t(o)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var o=this.state.popupVisible,n=this.props,i=n.children,r=n.forceRender,u=n.alignPoint,s=n.className,a=n.autoDestroy,l=c.Children.only(i),p={key:"trigger"};this.isContextMenuToShow()?p.onContextMenu=this.onContextMenu:p.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(p.onClick=this.onClick,p.onMouseDown=this.onMouseDown,p.onTouchStart=this.onTouchStart):(p.onClick=this.createTwoChains("onClick"),p.onMouseDown=this.createTwoChains("onMouseDown"),p.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(p.onMouseEnter=this.onMouseEnter,u&&(p.onMouseMove=this.onMouseMove)):p.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?p.onMouseLeave=this.onMouseLeave:p.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(p.onFocus=this.onFocus,p.onBlur=this.onBlur):(p.onFocus=this.createTwoChains("onFocus"),p.onBlur=this.createTwoChains("onBlur"));var d=T()(l&&l.props&&l.props.className,s);d&&(p.className=d);var f=(0,t.Z)({},p);(0,m.Yr)(l)&&(f.ref=(0,m.sQ)(this.triggerRef,l.ref));var h,v=c.cloneElement(l,f);return(o||this.popupRef.current||r)&&(h=c.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!o&&a&&(h=null),c.createElement(B.Provider,{value:this.triggerContextValue},v,h)}}],[{key:"getDerivedStateFromProps",value:function(e,o){var n=e.popupVisible,t={};return void 0!==n&&o.popupVisible!==n&&(t.popupVisible=n,t.prevPopupVisible=o.popupVisible),t}}]),g}(c.Component);return o.contextType=B,o.defaultProps={prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:U,getDocument:W,onPopupVisibleChange:z,afterPopupVisibleChange:z,onPopupAlign:z,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1},o}(g.Z)}}]);